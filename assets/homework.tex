\documentclass[letterpaper,10pt]{article}

\usepackage{color}
\usepackage{hyperref}
\usepackage{tabularx}
\usepackage{geometry}
\usepackage{float}
\usepackage{verbatim}

\geometry{left=1in,right=1in,top=0.8in,bottom=0.8in}
\hypersetup{hidelinks}
\setlength{\parskip}{0pt}
\setlength\parindent{0pt}

\renewcommand{\labelitemii}{$\circ$}
\newcommand{\listparam}{
    \setlength{\parsep}{\parskip}
    \setlength{\itemsep}{0.2ex}
    \setlength{\labelwidth}{2em}
    \setlength{\labelsep}{1em}
    \setlength{\topsep}{0pt}
    \setlength{\partopsep}{0.5ex}
    \setlength{\leftmargin}{2em}
}

\pagestyle{empty}

\renewcommand{\section}[1]{\vspace{5pt}{\large\textbf{#1}}\vspace{2pt}\hrule\vspace{2pt}}
\renewcommand{\subsection}[1]{\vspace{3pt}{\textbf{#1}}}

\begin{document}
\hfill{Homework2, Xuanyi Li, li.8720}

\section{Question 1}
\subsection{(1)}
$B_w = 64/4 =16, C_w = 1M, S = \frac{C_w}{B_w} = 64K$\\
\begin{table}[H]
\centering
\caption{}
\label{table1}
\begin{tabular}{llll}
  & A               & B         & C \\ \hline
i & N               & N         & N \\
j & $N/B_w$         & N         & $N/B_w$ \\ \hline
  & $N^2/B_w$       & $N^2$         & $N^2/B_w$
\end{tabular}
\end{table}
total \# cache misses = $2\frac{N^2}{B_w}+N^2 = 4.5 M$

\subsection{(2)}
$S = \frac{C_w}{E \times B_w} = 16K$\\
\begin{table}[H]
\centering
\caption{}
\label{table2}
\begin{tabular}{llll}
  & A               & B         & C \\ \hline
i & N               & N         & N \\
j & $N/B_w$         & N         & $N/B_w$ \\ \hline
  & $N^2/B_w$       & $N^2$         & $N^2/B_w$
\end{tabular}
\end{table}
total \# cache misses = $2\frac{N^2}{B_w}+N^2 = 4.5 M$

\subsection{(3)}
\begin{table}[H]
\centering
\caption{}
\label{tabel3}
\begin{tabular}{llll}
  & A               & B         & C \\ \hline
i & N               & $N/B_w$         & N \\
j & $N/B_w$         & N         & $N/B_w$ \\ \hline
  & $N^2/B_w$       & N         & $N^2/B_w$
\end{tabular}
\end{table}
total \# cache misses = $3 \times \frac{N^2}{B_w} = 0.75 M$

\subsection{(4)}
$C = N^2 \times 4 = 16M$ bytes

\subsection{(5)}
$E = 2048$

\section{Question 2}
\subsection{(1)}
\begin{table}[H]
\centering
\caption{}
\label{table4}
\begin{tabular}{llll}
       & A   & B           & C \\ \hline
$ijkl$ & 128 & $128^2=16K$ & 0
\end{tabular}
\end{table}

\subsection{(2)} $N=128, B_{dw}=128/8=16$ double words

(i)fully associative cache\\
\begin{table}[H]
\centering
\caption{}
\label{table5}
\begin{tabular}{llll}
  & A       & B & C       \\ \hline
i & N       & N & N       \\
j & 1       & N & $N/B_{dw}$ \\
k & $N/B_{dw}$ & N & 1       \\
l & N       & N & 1          \\ \hline
  & $N^3/B_{dw}=128K$ & $N^4=256M$ & $N^2/B_{dw}=1K$
\end{tabular}
\end{table}
\clearpage
(ii) direct-mapped cache
\begin{table}[H]
\centering
\caption{}
\label{table6}
\begin{tabular}{llll}
  & A       & B & C       \\ \hline
i & N       & N & N       \\
j & 1       & N & $N/B_{dw}$ \\
k & $N/B_{dw}$ & N & 1       \\
l & N       & N & 1          \\ \hline
  & $N^3/B_{dw}=128K$ & $N^4=256M$ & $N^2/B_{dw}=1K$
\end{tabular}
\end{table}

\subsection{(3)}


(i)fully associative\\
\begin{table}[H]
\centering
\caption{}
\label{table7}
\begin{tabular}{llll}
  & A     & B            & C            \\ \hline
i & N     & N            & 1            \\
j & N     & N            & 1            \\
k & N     & 1            & N            \\
l & 1     & $N/B_{dw}$   & $N/B_{dw}$   \\ \hline
  & $N^3=2M$ & $N^3/B_{dw}=128K$ & $N^2/B_{dw}=1K$
\end{tabular}
\end{table}

(ii)direct-mapped
\begin{table}[H]
\centering
\caption{}
\label{table8}
\begin{tabular}{llll}
  & A     & B            & C            \\ \hline
i & N     & N            & 1            \\
j & N     & N            & 1            \\
k & N     & 1            & N            \\
l & 1     & $N/B_{dw}$   & $N/B_{dw}$   \\ \hline
  & $N^3=2M$ & $N^3/B_{dw}=128K$ & $N^2/B_{dw}=1K$
\end{tabular}
\end{table}

\section{Question 3}
\begin{verbatim}
double A[512][512], B[512][512]
for(k=0; k<512; k++)
    for(i=0; i<k; i++)
        for(j=0; j<512; j++)
            C[i][j] += A[i][k]*B[k][j]
\end{verbatim}

\section{Question 4}
\begin{verbatim}
for(i = 0; i<512; i+=2)
    for(j =0; j<512; j+=2)
        C[i][j] += A[i][i]*B[i][j]
        C[i][j+1] += A[i][i]*B[i][j+1]
        for(k = i+1; k<512; k++)
            C[i][j] += A[i][k]*B[k][j]
            C[i][j+1] += A[i][k]*B[k][j+1]
            C[i+1][j] += A[i+1][k]*B[k][j+1]
            C[i+1][j+1] += A[i+1][k]*B[k][j+1]

\end{verbatim}


\end{document}
